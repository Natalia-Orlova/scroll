<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="zoomBtns">
        <button id="zoomIn">+</button>
        <input type="range" min="20" max="300" value="50" id="zoomRange">
        <button id="zoomOut">-</button>
    </div>
    <div id="layer">
        <img id="img" src="img4.jpg" style="margin: 0px 0px 0px 0px; transform: scale(0.5)">
    </div>

    <script>
        const img = document.getElementById('img');
        const zoomInButton = document.getElementById("zoomIn");
        const zoomOutButton = document.getElementById("zoomOut");
        const zoomRange = document.getElementById("zoomRange");
        img.style.cursor = 'grab';

        //перемещение
        img.addEventListener('mousedown', (e) => {
            let shiftX = e.clientX - img.offsetLeft;
            let shiftY = e.clientY - img.offsetTop;
            img.style.cursor = 'grabbing';


            document.onmousemove = function (e) {
                let left = e.clientX - shiftX + 'px';
                let top = e.clientY - shiftY + 'px';
                img.style.margin = `${top} 0 0 ${left}`;
            };

            document.onmouseup = function () {
                document.onmousemove = null;
                document.onmouseup = null;
                img.style.cursor = 'grab';
            };
        });

        //отключить собственный drag'n'drop браузера
        img.ondragstart = function () {
            return false;
        };


        //работает без смещения картинки
        let zoomLevel = 0.5;
        img.addEventListener('wheel', function (e) {
            e.preventDefault();
            if (e.deltaY < 0 && zoomLevel <= 3) {
                zoomLevel += 0.1;
                zoomRange.value = parseInt(zoomRange.value, 10) + 10;

            } else if (e.deltaY > 0 && zoomLevel > 0.2) { // ограничение, чтобы scale не уходил в минус
                zoomLevel -= 0.1;
                zoomRange.value = parseInt(zoomRange.value, 10) - 10;
            }
            let offsetX = (e.clientX - img.offsetLeft) / img.offsetWidth * 100;
            let offsetY = (e.clientY - img.offsetTop) / img.offsetHeight * 100;

            img.style.transformOrigin = `${offsetX}% ${offsetY}%`;
            img.style.transform = `scale(${zoomLevel})`;
        });



        //кнопки + -
        zoomInButton.addEventListener("click", function () {
            zoomRange.value = parseInt(zoomRange.value, 10) + 10;
            scaleContent();
        });

        zoomOutButton.addEventListener("click", function () {
            zoomRange.value = parseInt(zoomRange.value, 10) - 10;
            scaleContent();
        });

        zoomRange.addEventListener("input", function () {
            scaleContent();
        });

        function scaleContent() {
            img.style.transform = `scale(${zoomRange.value / 100})`;
        }
    </script>
</body>

</html>